(function(){$(function(){var n=function(){var i=$(this),n=$("input[name^='F_TYPE_OTHER_']",i.parentsUntil("fieldset > div","div")),r,t;"Other"===i.val()?n.removeAttr("disabled").attr("required","required").parent().removeAttr("disabled").addClass("required").children("span").prepend("<mark>* <\/mark>"):n.attr("disabled","disabled").removeAttr("required").val("").parent().attr("disabled","disabled").removeClass("required").removeClass("invalid").find("mark").remove();n=$("label",i.parentsUntil("fieldset","fieldset > div")).not(i.parent());""===i.val()?n.find("label,select,input").add(n).val("").attr("disabled","disabled").removeAttr("required").removeClass("required").removeClass("invalid").find("mark").remove():n.find("input.number,input.date").removeAttr("disabled").attr("required","required").parent().not(".required").removeAttr("disabled").addClass("required").children("span").prepend("<mark>* <\/mark>");r=n.find("input.number,input.date");n=n.not(r.add(r.parent()));t="";switch(i.val()){case"Cash":t=n.find("input[name*='NAME'],input[name*='ACCOUNT'],input[name*='ROUTING'],input[name*='SWIFT'],input[name^='F_TYPE_OTHER_']");t=t.add(t.parent());t.attr("disabled","disabled").removeClass("required").removeClass("invalid").val("");n.find("label,select,input").add(n).not(t).removeAttr("disabled");break;case"Check":case"CreditCard":case"MoneyOrder":case"WireTransfer":case"PrepaidCard":case"Other":t=n.find("input[name^='F_TYPE_OTHER_'],select[class='state']");n.find("label,select,input").add(n).not(t).not(t.parent()).removeAttr("disabled");break;case"VirtualCurrency":t=n.find("input[name*='NAME'],input[name*='ACCOUNT']");t.removeAttr("disabled").removeAttr("required").parent().removeAttr("disabled").removeClass("required").find("mark").remove();n.find("label,input,select").not(t).not(t.parent()).val("").removeAttr("required").removeClass("required").attr("disabled","disabled").find("mark").removeClass("invalid").remove()}},t=$('<input type="date">').prop("type")==="date"?function(){var n=$(this),t=n.val().replace(/^(\d{4})-(\d{2})-(\d{2})$/,"$2/$3/$1");n.attr("type","text").attr("pattern",n.data("pattern")).attr("title",n.data("title")).removeData("pattern").removeData("title").val(t)}:function(){},i=$('<input type="date">').prop("type")==="date"?function(){var n=$(this),t=n.val(),i=/^(\d{2})\/(\d{2})\/(\d{4})$/;n.data("pattern",n.attr("pattern")).data("title",n.attr("title")).removeAttr("title").removeAttr("pattern").attr("type","date");i.test(t)&&n.val(t.replace(i,"$3-$1-$2"))}:function(){};$("input.date").focus(i).blur(t);var r=function(){var t=$("input[name='I_USED'][value='OTHER']"),n=$("input[name='I_USED_OTHER']");n=n.add(n.parent());t.prop("checked")?n.removeAttr("disabled"):n.val("").attr("disabled","disabled")},u=function(){var n=$(this),i=$("input[name^='"+n.attr("name").substr(0,4)+"']",n.parentsUntil("fieldset","div")).not("input[name*='NAME'],input[name*='NUMBER'],input[name*='SWIFT_CODE']"),r=i.map(function(){return this.value.trim().length}).get().sort(function(n,t){return t-n}),t=$("select[name^='"+n.attr("name").substr(0,4)+"'][class='country']",n.parentsUntil("fieldset","div"));0===r[0]?t.removeAttr("required").parent().removeClass("required").find("mark").remove():t.not("[required='required']").attr("required","required").parent().addClass("required").children("span").prepend("<mark>* <\/mark>")},f=function(){var n=$(this),t=n.closest("div,section").find("select[class='state']");"F_"===n.attr("name").substr(0,2)&&(t=$("[name^='"+n.attr("name").substr(0,4)+"']",t.parent()));"USA"===n.val()?t.removeAttr("disabled").not("[name^='F_R_'],[name^='P_']").attr("required","required").end().parent().removeAttr("disabled").end().not("[name^='F_R_'],[name^='P_']").parent().addClass("required").children("span").prepend("<mark>* <\/mark>"):t.val("").removeAttr("required").attr("disabled","disabled").parent().removeClass("required").attr("disabled","disabled").find("mark").removeClass("invalid").remove()},e=function(){var n=$(this),t=n.attr("name"),i,r;return t=Number(t.substring(t.lastIndexOf("_")+1)),n=n.parent(),i=n.parent(),n.add(n.prev("hr")).remove(),r=$("[name]",i).each(function(){var t=$(this),n=t.attr("name"),i=Number(n.substring(n.lastIndexOf("_")+1)),r;i!==1&&(r=$("[name^='"+n.substring(0,n.lastIndexOf("_"))+"']").index(t)+(t.is(".rm")?2:1),i>r&&(t.attr("name",n.substring(0,n.lastIndexOf("_")+1)+r),t.is("[data-field]")&&(n=t.attr("data-field"),t.attr("data-field",n.substring(0,n.indexOf(i))+r+n.substring(n.indexOf(i)+i.toString().length)))))}),$("button[name='submitAct']",i).find("*").addBack().removeAttr("disabled"),!1};$("select[name^='F_TYPE_']").change(n).change();$("input[name^='F_V_'],input[name^='F_R_']").not("input[name*='NAME'],input[name*='NUMBER'],input[name*='SWIFT_CODE']").change(u);$("select[name='CO']").change(function(){var t=$(this),n=$("div",t.parentsUntil("section","fieldset"));"N"===t.val()?(n.find("*").removeAttr("disabled"),n.find("input[name='C_NAME']").attr("required","required").parent().addClass("required").children("span").prepend("<mark>* <\/mark>")):(n.find("*").val("").attr("disabled","disabled").removeClass("invalid"),n.find("input[name='C_NAME']").removeAttr("required").parent().removeClass("required").find("mark").remove())}).change();$("button[name='submitAct']").click(function(){var s=$(this),o=$("fieldset > div",s.parentsUntil("section#questions","section > section")),r;return o.length>=9&&s.find("*").addBack().attr("disabled","disabled"),r=$('<hr><div><button class="rm" type="submit" formnovalidate name="RM_'+o.find("[name]").attr("name").substr(0,1)+'_1"><span title="Remove"><\/span> <span>Remove<\/span><\/button>'+o[0].innerHTML+"<\/div>"),$("[name$='_1']",r).val("").attr("name",function(){return $(this).attr("name").replace("_1","_"+(o.length+1))}).filter("[data-field]").attr("data-field",function(){return $(this).attr("data-field").replace(" 1 "," "+(o.length+1)+" ")}),$("button.rm",r).click(e),$("input[name^='F_V_'],input[name^='F_R_']",r).not("input[name*='NAME'],input[name*='NUMBER'],input[name*='SWIFT_CODE']").change(u),$("select[class='country']",r).change(f).change(),$("input.date",r).focus(i).blur(t),s.parent().before(r),$("select[name^='F_TYPE_']",r).change(n).change(),!1});$("input[name='I_USED'][value='OTHER']").click(r);r();$("select[class='country']").change(f).change();$("#sub").click(function(){var u=$("#validation"),f,t,i,e,o,r,s,n;if(u.html(""),f=[],t=[],$("[required]:not([disabled]").each(function(){var n=$(this);n.val()===""||n.val()===null?(n.parent().addClass("invalid"),t.push(n.attr("data-field")),f.push(n.attr("name"))):n.parent().removeClass("invalid")}),0<t.length&&(u.html('<section id="req"><h1>The following complaint fields must be filled out:<\/h1><ul><\/ul><\/section>'),$("#req ul",u).html($.map(t,function(n){return"<li>"+n+"<\/li>"}).join(""))),t=[],$("[pattern],.number").not("[disabled],.date").each(function(){var n=$(this),i=new RegExp("^(?:"+(n.attr("pattern")||n.attr("data-pattern"))+")$","i");f.indexOf(n.attr("name"))<0&&(n.val()===""||i.test(n.val())&&(!n.hasClass("ip")||(n.val().match(/::/g)||"1").length<=1)&&(!n.hasClass("number")||(n[0].checkValidity?n[0].checkValidity():isNaN(Number(n.val()))?!1:Number(n.val())<=Number(n.attr("max"))&&Number(n.val())>=Number(n.attr("min"))))?n.parent().removeClass("invalid"):(n.parent().addClass("invalid"),t.push(n.attr("data-field")+" - "+n.attr("title")),f.push(n.attr("name"))))}),i=[],$("input.email:not([disabled])").each(function(){var n=$(this);f.indexOf(n.attr("name"))<0&&(n.val()!==""?i.push([n.attr("name"),n.val()]):n.parent().removeClass("invalid"))}),0<i.length)if($("input.email").prop("type")==="email")for(n=0;n<i.length;n++)e=$("input[name='"+i[n][0]+"']"),e[0].checkValidity()?e.parent().removeClass("invalid"):(e.parent().addClass("invalid"),t.push(e.attr("data-field")+" - Please enter a standard email address."));else{for(o="",n=0;n<i.length;n++)o=o+i[n][0]+","+encodeURIComponent(i[n][1])+";";$.ajax("checkemail",{async:!1,dataType:"json",jsonp:!1,method:"POST",data:{c:$("input[name='COMPLAINT_SESSION']").val(),e:o}}).done(function(n){for(var r,i=0;i<n.o.length;i++)r=$("input[name='"+n.o[i].n+"']"),n.o[i].e==="T"?r.parent().removeClass("invalid"):(r.parent().addClass("invalid"),t.push(r.attr("data-field")+" - Please enter a standard email address."))}).fail(function(){for(var n=0;n<r.length;n++)$("input[name='"+i[n][0]+"']").parent().removeClass("invalid")})}if(r=[],$("input.date:not([disabled])").each(function(){var n=$(this),i;f.indexOf(n.attr("name"))<0&&(n.val()!==""?(i=new RegExp("^(?:"+n.attr("pattern")+")$","i"),i.test(n.val())?r.push([n.attr("name"),n.val()]):(n.parent().addClass("invalid"),t.push(n.attr("data-field")+" - "+n.attr("title")))):n.parent().removeClass("invalid"))}),0<r.length){for(s="",n=0;n<r.length;n++)s=s+r[n][0]+","+encodeURIComponent(r[n][1])+";";$.ajax("checkdate",{async:!1,dataType:"json",jsonp:!1,method:"POST",data:{c:$("input[name='COMPLAINT_SESSION']").val(),d:s}}).done(function(n){for(var r,i=0;i<n.o.length;i++)r=$("input[name='"+n.o[i].n+"']"),n.o[i].d==="T"?r.parent().removeClass("invalid"):(r.parent().addClass("invalid"),t.push(r.attr("data-field")+" - "+r.attr("title")))}).fail(function(){for(var n=0;n<r.length;n++)$("input[name='"+r[n][0]+"']").parent().removeClass("invalid")})}return 0<t.length&&(u.html(u.html()+'<section id="rx"><h1>The following complaint fields have invalid responses and must be corrected:<\/h1><ul><\/ul><\/section>'),$("#rx ul",u).html($.map(t.sort(),function(n){return"<li>"+n+"<\/li>"}).join(""))),0<$("section",u).length?(window.location="#validation",!1):void 0}),function(){var n=$("input.number");n.prop("type")!=="number"&&n.each(function(){var n=$(this);n.attr("maxlength",n.attr("max").length)})}()})})()